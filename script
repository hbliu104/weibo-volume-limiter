// ==UserScript==
// @name         Sound Limiter for Weibo Video Clips
// @name:zh-CN   微博视频音量限制器
// @namespace    http://tampermonkey.net/
// @version      0.3
// @description  Limit the default sound volume of video clips on weibo.com to 10%.
// @description:zh-cn  限制微博视频的默认音量为10%
// @icon         https://raw.githubusercontent.com/hbliu104/weibo-volume-limiter/main/vol_down.png
// @author       Lophelia
// @include        http://f.video.weibocdn.com/*
// @include        https://video.h5.weibo.cn/*
// @include        https://*weibo.com/*
// @require  http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js
// @require https://greasyfork.org/scripts/5392-waitforkeyelements/code/WaitForKeyElements.js?version=115012
// @run-at document-idle
// ==/UserScript==
 
volume_down();
 
waitForKeyElements ("video", volume_down);
 
function volume_down () {
    let videos = document.getElementsByTagName('video');
    for (let idx = 0; idx < videos.length; idx++)
    {
        if (videos[idx].hasAttribute('autoplay'))
        {
            videos[idx].removeAttribute('autoplay');
        }
        videos[idx].volume = 0.1;
    }
}
